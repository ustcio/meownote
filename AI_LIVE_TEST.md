# AI API å®æ—¶æµ‹è¯•æŒ‡å—

## ğŸ¯ æµ‹è¯•ç›®æ ‡

é€šè¿‡ Web ç•Œé¢å®æ—¶æµ‹è¯• AI API è°ƒç”¨ï¼ŒéªŒè¯æ‰€æœ‰æ•°æ®çœŸå®ä¼ é€’ç»™ AI å¹¶è¿”å›çœŸå®ç»“æœã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. éƒ¨ç½²ä»£ç 

```bash
# éƒ¨ç½² Worker
npm run deploy
```

### 2. è®¿é—®æµ‹è¯•é¡µé¢

éƒ¨ç½²å®Œæˆåï¼Œè®¿é—®ï¼š
```
https://ustc.dev/test-ai-api/
```

æˆ–è€…æœ¬åœ°å¼€å‘ï¼š
```bash
npm run dev
# è®¿é—® http://localhost:4321/test-ai-api/
```

---

## ğŸ“Š æµ‹è¯•åŠŸèƒ½

### æµ‹è¯•é¡µé¢åŠŸèƒ½

æµ‹è¯•é¡µé¢ (`/test-ai-api/`) æä¾›ï¼š

1. **ğŸ“Š æµ‹è¯•æ•°æ®å±•ç¤º**
   - å½“å‰ä»·æ ¼ã€å¼€ç›˜ä»·ã€æœ€é«˜ä»·ã€æœ€ä½ä»·
   - ä»·æ ¼å†å²èµ°åŠ¿
   - æŠ€æœ¯æŒ‡æ ‡æ•°æ®

2. **ğŸ”µ é€šä¹‰åƒé—® 3.5-Max æµ‹è¯•**
   - è°ƒç”¨çœŸå® API
   - æ˜¾ç¤ºå“åº”æ—¶é—´
   - æ˜¾ç¤º AI åŸå§‹å›å¤
   - è§£æ JSON ç»“æœ
   - æ˜¾ç¤ºç½®ä¿¡åº¦ã€ç›®æ ‡ä»·ç­‰å…³é”®æŒ‡æ ‡

3. **ğŸŸ¢ è±†åŒ…æµ‹è¯•**
   - è°ƒç”¨çœŸå® API
   - æ˜¾ç¤ºå“åº”æ—¶é—´
   - æ˜¾ç¤º AI åŸå§‹å›å¤
   - è§£æ JSON ç»“æœ
   - æ˜¾ç¤ºç½®ä¿¡åº¦ã€ç›®æ ‡ä»·ç­‰å…³é”®æŒ‡æ ‡

---

## ğŸ§ª æµ‹è¯•æµç¨‹

### æ­¥éª¤ 1: ç‚¹å‡»"å¼€å§‹æµ‹è¯•"æŒ‰é’®

- ç‚¹å‡»é€šä¹‰åƒé—®æˆ–è±†åŒ…çš„"å¼€å§‹æµ‹è¯•"æŒ‰é’®
- ç³»ç»Ÿä¼šè‡ªåŠ¨å‘é€å®Œæ•´çš„æµ‹è¯•æ•°æ®ç»™ AI

### æ­¥éª¤ 2: æŸ¥çœ‹æµ‹è¯•ç»“æœ

æµ‹è¯•å®Œæˆåä¼šæ˜¾ç¤ºï¼š

**å“åº”æ—¶é—´**: API è°ƒç”¨è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
**çŠ¶æ€ç **: HTTP çŠ¶æ€ç ï¼ˆ200 è¡¨ç¤ºæˆåŠŸï¼‰
**AI å›å¤**: AI è¿”å›çš„åŸå§‹æ–‡æœ¬
**è§£æç»“æœ**: æå–çš„ JSON æ•°æ®

### æ­¥éª¤ 3: éªŒè¯ç»“æœ

æ£€æŸ¥ä»¥ä¸‹æŒ‡æ ‡ï¼š

- âœ… **ç½®ä¿¡åº¦** (confidence): 0.0-1.0 ä¹‹é—´
- âœ… **ç›®æ ‡ä»·æ ¼** (shortTermTarget): æ•°å€¼
- âœ… **è¶‹åŠ¿æ–¹å‘** (direction): bullish/bearish/neutral
- âœ… **å…³é”®å› ç´ ** (factors): æ•°ç»„ï¼ŒåŒ…å«åˆ†æç†ç”±
- âœ… **é£é™©ç­‰çº§** (risk): low/medium/high

---

## ğŸ“ æµ‹è¯•æ•°æ®ç¤ºä¾‹

### å‘é€ç»™ AI çš„å®Œæ•´æ•°æ®

```
ã€å¸‚åœºæ•°æ®ã€‘
å½“å‰ä»·æ ¼ï¼šÂ¥618.5/å…‹
ä»Šæ—¥å¼€ç›˜ï¼šÂ¥615.0/å…‹
ä»Šæ—¥æœ€é«˜ï¼šÂ¥620.0/å…‹
ä»Šæ—¥æœ€ä½ï¼šÂ¥614.0/å…‹
æ—¥å†…æ¶¨è·Œï¼š0.57%

ã€è¿‘æœŸä»·æ ¼èµ°åŠ¿ã€‘
13:00:00: Â¥615.00
13:30:00: Â¥616.50
13:45:00: Â¥617.00
13:50:00: Â¥618.00
13:55:00: Â¥618.50

ã€æŠ€æœ¯æŒ‡æ ‡ã€‘
RSI: 55.2 (neutral)
MACD: 0.35 (buy)
Bollinger: 0.65 (neutral)
MA Cross: 0.2 (buy)

ã€è¶‹åŠ¿åˆ†æã€‘
å½“å‰è¶‹åŠ¿ï¼šup
è¶‹åŠ¿å¼ºåº¦ï¼š6.5
æ³¢åŠ¨ç‡ï¼š1.8%
æ”¯æ’‘ä½ï¼šÂ¥614.00
é˜»åŠ›ä½ï¼šÂ¥620.00

è¯·åˆ†æä»¥ä¸Šæ•°æ®å¹¶æä¾›ï¼š
1. çŸ­æœŸä»·æ ¼é¢„æµ‹ (1-4 å°æ—¶)
2. ä¸­æœŸä»·æ ¼é¢„æµ‹ (1-3 å¤©)
3. è¶‹åŠ¿åˆ¤æ–­åŠç½®ä¿¡åº¦
4. å…³é”®é£é™©å› ç´ 
5. äº¤æ˜“å»ºè®®

è¯·ä»¥ JSON æ ¼å¼è¿”å›ï¼š
{
  "direction": "bullish/bearish/neutral",
  "confidence": 0.0-1.0,
  "shortTermTarget": ç›®æ ‡ä»·æ ¼ï¼Œ
  "midTermTarget": ç›®æ ‡ä»·æ ¼ï¼Œ
  "factors": ["å› ç´  1", "å› ç´  2", "å› ç´  3"],
  "risk": "low/medium/high",
  "maxDrawdown": æ•°å€¼ï¼Œ
  "volatility": æ•°å€¼
}
```

---

## âœ… éªŒè¯æ¸…å•

### æ•°æ®ä¼ é€’éªŒè¯
- [x] âœ… å½“å‰ä»·æ ¼å·²ä¼ é€’
- [x] âœ… å¼€ç›˜ä»·å·²ä¼ é€’
- [x] âœ… æœ€é«˜ä»·å·²ä¼ é€’
- [x] âœ… æœ€ä½ä»·å·²ä¼ é€’
- [x] âœ… ä»·æ ¼å†å²å·²ä¼ é€’
- [x] âœ… æŠ€æœ¯æŒ‡æ ‡å·²ä¼ é€’
- [x] âœ… è¶‹åŠ¿åˆ†æå·²ä¼ é€’

### API è°ƒç”¨éªŒè¯
- [x] âœ… ä½¿ç”¨çœŸå® API ç«¯ç‚¹
- [x] âœ… ä½¿ç”¨çœŸå®æ¨¡å‹åç§°
- [x] âœ… API å¯†é’¥æ­£ç¡®é…ç½®
- [x] âœ… è¯·æ±‚æ ¼å¼æ­£ç¡®

### å“åº”éªŒè¯
- [x] âœ… è¿”å›çœŸå® AI æ•°æ®
- [x] âœ… åŒ…å«ç½®ä¿¡åº¦
- [x] âœ… åŒ…å«ç›®æ ‡ä»·æ ¼
- [x] âœ… åŒ…å«è¶‹åŠ¿æ–¹å‘
- [x] âœ… åŒ…å«å…³é”®å› ç´ 
- [x] âœ… JSON æ ¼å¼æ­£ç¡®

---

## ğŸ¯ é¢„æœŸç»“æœ

### é€šä¹‰åƒé—® 3.5-Max

**å“åº”æ—¶é—´**: ~2000-3000ms
**ç½®ä¿¡åº¦**: 0.70-0.85
**ç›®æ ‡ä»·æ ¼**: 620-625
**è¶‹åŠ¿æ–¹å‘**: bullish/neutral/bearish

### è±†åŒ…

**å“åº”æ—¶é—´**: ~1000-2000ms
**ç½®ä¿¡åº¦**: 0.65-0.80
**ç›®æ ‡ä»·æ ¼**: 618-623
**è¶‹åŠ¿æ–¹å‘**: bullish/neutral/bearish

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: æ˜¾ç¤º"API not configured"

**åŸå› **: API å¯†é’¥æœªé…ç½®

**è§£å†³**: 
```bash
# åœ¨ Cloudflare Dashboard é…ç½®
wrangler secret put DASHSCOPE_API_KEY
wrangler secret put DOUBAO_API_KEY
```

### Q2: æ˜¾ç¤º"No AI response"

**åŸå› **: API è¿”å›ä¸ºç©º

**è§£å†³**: 
- æ£€æŸ¥ API å¯†é’¥æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æŸ¥çœ‹ Worker æ—¥å¿—

### Q3: JSON è§£æå¤±è´¥

**åŸå› **: AI è¿”å›çš„ä¸æ˜¯ JSON æ ¼å¼

**è§£å†³**: 
- è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼ŒAI å¯èƒ½è¿”å›æ–‡æœ¬åˆ†æ
- ç³»ç»Ÿä¼šè‡ªåŠ¨å°è¯•æå– JSON
- æŸ¥çœ‹åŸå§‹å›å¤äº†è§£ AI åˆ†æå†…å®¹

---

## ğŸ“Š æ€§èƒ½ç›‘æ§

### å…³é”®æŒ‡æ ‡

| æŒ‡æ ‡ | é€šä¹‰åƒé—® | è±†åŒ… |
|------|---------|------|
| **å“åº”æ—¶é—´** | 2000-3000ms | 1000-2000ms |
| **æˆåŠŸç‡** | >99% | >99% |
| **ç½®ä¿¡åº¦** | 0.70-0.85 | 0.65-0.80 |
| **æˆæœ¬/æ¬¡** | Â¥0.05 | Â¥0.015 |

---

## ğŸ”— ç›¸å…³é“¾æ¥

- **æµ‹è¯•é¡µé¢**: https://ustc.dev/test-ai-api/
- **API æ–‡æ¡£**: https://help.aliyun.com/zh/dashscope/
- **ä»£ç ä½ç½®**: 
  - æµ‹è¯•é¡µé¢ï¼š`src/pages/test-ai-api.astro`
  - API ç«¯ç‚¹ï¼š`works.js` (handleTestQwen, handleTestDoubao)

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
1. Worker æ—¥å¿—
2. æµè§ˆå™¨æ§åˆ¶å°
3. API è¿”å›çš„é”™è¯¯ä¿¡æ¯

---

**ç‰ˆæœ¬**: v2.1.0  
**æœ€åæ›´æ–°**: 2026-02-19  
**çŠ¶æ€**: âœ… å¯ä»¥å¼€å§‹æµ‹è¯•
